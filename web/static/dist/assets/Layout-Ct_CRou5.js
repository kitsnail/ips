import{u as w,a as B}from"./index-Cnh6YuTo.js";import{h as f,r as L,d as T,A as V,a as p,b as s,j as r,F as y,B as S,u as l,C as F,D as c,f as u,w as _,i as h,o as v,G as I}from"./element-plus-DT46MLQ6.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const t=L(null),D=()=>{const b=f(()=>!!t.value),i=f(()=>t.value?.role==="admin");return{user:t,isAuthenticated:b,isAdmin:i,loadUser:()=>{const a=localStorage.getItem("ips_user");if(a)try{t.value=JSON.parse(a)}catch(o){console.error("Failed to parse user from localStorage",o)}},setUser:a=>{t.value=a,localStorage.setItem("ips_user",JSON.stringify(a))},clearUser:()=>{t.value=null,localStorage.removeItem("ips_user")}}},J={class:"layout"},M={class:"header"},O={class:"header-content"},j={class:"nav-tabs"},z={class:"user-info"},E={class:"user-avatar"},G={class:"username"},P={class:"main-content"},q=T({__name:"Layout",setup(b){const i=w(),k=B(),{user:d,isAdmin:m,loadUser:a}=D(),o=f(()=>k.path);V(()=>{a()});const C=[{name:"Dashboard",path:"/dashboard",label:"概览"},{name:"Tasks",path:"/tasks",label:"任务管理"},{name:"ScheduledTasks",path:"/scheduled",label:"定时任务"},{name:"Library",path:"/library",label:"镜像库"},{name:"Secrets",path:"/secrets",label:"仓库认证"}],U=[{name:"Admin",path:"/admin",label:"系统设置"}],A=()=>{localStorage.removeItem("ips_token"),localStorage.removeItem("ips_user"),i.push("/")};return(H,n)=>{const g=h("router-link"),x=h("el-button"),N=h("router-view");return v(),p("div",J,[s("div",M,[s("div",O,[n[1]||(n[1]=s("h1",{class:"logo"},[s("span",{class:"logo-icon"}),r(" 镜像预热控制台（IPS） ")],-1)),s("nav",j,[(v(),p(y,null,S(C,e=>u(g,{key:e.path,to:e.path,class:I(["nav-link",{active:o.value===e.path}])},{default:_(()=>[r(c(e.label),1)]),_:2},1032,["to","class"])),64)),l(m)?(v(),p(y,{key:0},S(U,e=>u(g,{key:e.path,to:e.path,class:I(["nav-link",{active:o.value===e.path,"admin-only":!l(m)}])},{default:_(()=>[r(c(e.label),1)]),_:2},1032,["to","class"])),64)):F("",!0)]),s("div",z,[s("div",E,c(l(d)?.username?.charAt(0).toUpperCase()),1),s("span",G,c(l(d)?.username),1),u(x,{text:"",onClick:A},{default:_(()=>[...n[0]||(n[0]=[r("退出登录",-1)])]),_:1})])])]),s("div",P,[u(N)])])}}}),X=R(q,[["__scopeId","data-v-4a2f77a7"]]);export{X as default};
