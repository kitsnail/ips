import{u as N,a as B}from"./index-BzXyuT2b.js";import{c as b,r as L,d as T,g as p,j as s,v as n,F as y,A as S,u as r,B as V,C as l,k as c,l as _,q as h,t as v,D as I}from"./element-plus-BS5ldEX1.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";const a=L(null),F=()=>{const f=b(()=>!!a.value),u=b(()=>a.value?.role==="admin");return{user:a,isAuthenticated:f,isAdmin:u,loadUser:()=>{const t=localStorage.getItem("ips_user");if(t)try{a.value=JSON.parse(t)}catch(m){console.error("Failed to parse user from localStorage",m)}},setUser:t=>{a.value=t,localStorage.setItem("ips_user",JSON.stringify(t))},clearUser:()=>{a.value=null,localStorage.removeItem("ips_user")}}},R={class:"layout"},D={class:"header"},J={class:"header-content"},O={class:"nav-tabs"},j={class:"user-info"},q={class:"user-avatar"},z={class:"username"},E={class:"main-content"},M=T({__name:"Layout",setup(f){const u=N(),k=B(),{user:i,isAdmin:d}=F(),t=b(()=>k.path),m=[{name:"Dashboard",path:"/dashboard",label:"概览"},{name:"Tasks",path:"/tasks",label:"任务管理"},{name:"ScheduledTasks",path:"/scheduled",label:"定时任务"},{name:"Library",path:"/library",label:"镜像库"},{name:"Secrets",path:"/secrets",label:"仓库认证"}],C=[{name:"Admin",path:"/admin",label:"系统设置"}],A=()=>{localStorage.removeItem("ips_token"),localStorage.removeItem("ips_user"),u.push("/")};return(P,o)=>{const g=h("router-link"),U=h("el-button"),x=h("router-view");return v(),p("div",R,[s("div",D,[s("div",J,[o[1]||(o[1]=s("h1",{class:"logo"},[s("span",{class:"logo-icon"}),n(" 镜像预热控制台（IPS） ")],-1)),s("nav",O,[(v(),p(y,null,S(m,e=>c(g,{key:e.path,to:e.path,class:I(["nav-link",{active:t.value===e.path}])},{default:_(()=>[n(l(e.label),1)]),_:2},1032,["to","class"])),64)),r(d)?(v(),p(y,{key:0},S(C,e=>c(g,{key:e.path,to:e.path,class:I(["nav-link",{active:t.value===e.path,"admin-only":!r(d)}])},{default:_(()=>[n(l(e.label),1)]),_:2},1032,["to","class"])),64)):V("",!0)]),s("div",j,[s("div",q,l(r(i)?.username?.charAt(0).toUpperCase()),1),s("span",z,l(r(i)?.username),1),c(U,{text:"",onClick:A},{default:_(()=>[...o[0]||(o[0]=[n("退出登录",-1)])]),_:1})])])]),s("div",E,[c(x)])])}}}),Q=w(M,[["__scopeId","data-v-03314adc"]]);export{Q as default};
