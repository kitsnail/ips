import{g as x,r as D,d as H,o as t,c as f,v as l,q as e,B as ee,C as te,l as c,D as j,F as S,a as p,G as v,H as O,t as u,I as P,z as G,J as se,K as le,L as ae,M as oe,N as re,O as ne,P as de,Q as ie,R as ce,u as ue,T as pe}from"./element-plus-K37pJI3g.js";import{a as q,u as he}from"./index-DmX7KA4i.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L=D(null),Q=()=>{const M=x(()=>!!L.value),r=x(()=>L.value?.role==="admin");return{user:L,isAuthenticated:M,isAdmin:r,loadUser:()=>{const o=localStorage.getItem("ips_user");if(o)try{L.value=JSON.parse(o)}catch(m){console.error("Failed to parse user from localStorage",m)}},setUser:o=>{L.value=o,localStorage.setItem("ips_user",JSON.stringify(o))},clearUser:()=>{L.value=null,localStorage.removeItem("ips_user")}}},me={class:"h-16 flex items-center justify-center border-b border-gray-100 dark:border-slate-800 mb-2 overflow-hidden"},be={class:"flex items-center gap-3"},_e={class:"text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-slate-800 to-slate-600 dark:from-white dark:to-slate-300 transition-all duration-300"},ge={key:0,class:"ml-auto px-1.5 py-0.5 text-xs font-medium bg-green-500 text-white rounded transform scale-90"},ke=H({__name:"Sidebar",props:{collapsed:{type:Boolean}},setup(M){const r=q(),{isAdmin:h}=Q(),I=x(()=>r.path),n=[{id:"dashboard",icon:se,label:"概览",path:"/dashboard"},{id:"tasks",icon:le,label:"任务管理",path:"/tasks",children:[{id:"tasks-list",label:"全部任务",path:"/tasks"},{id:"tasks-create",label:"创建任务",path:"/tasks/create"}]},{id:"scheduled",icon:ae,label:"定时任务",path:"/scheduled",children:[{id:"scheduled-list",label:"任务列表",path:"/scheduled"},{id:"scheduled-history",label:"执行历史",path:"/scheduled/history"}]},{id:"library",icon:oe,label:"镜像库",path:"/library",children:[{id:"library-list",label:"镜像管理",path:"/library"},{id:"library-import",label:"批量导入",path:"/library/import"}]},{id:"secrets",icon:re,label:"仓库认证",path:"/secrets",children:[{id:"secrets-list",label:"认证列表",path:"/secrets"},{id:"secrets-create",label:"添加认证",path:"/secrets/create"}]}],o=[{id:"admin",icon:ne,label:"系统设置",path:"/admin",children:[{id:"admin-users",label:"用户管理",path:"/admin/users"},{id:"admin-settings",label:"系统配置",path:"/admin/settings"},{id:"admin-logs",label:"系统日志",path:"/admin/logs"}]}],m=x(()=>h.value?[...n,...o]:n);return(b,y)=>{const d=p("el-icon"),_=p("el-menu-item"),g=p("el-sub-menu"),k=p("el-menu");return t(),f(k,{"default-active":I.value,collapse:M.collapsed,"collapse-transition":!1,router:"",class:"border-r-0 h-full bg-white dark:bg-slate-900","active-text-color":"#0891b2"},{default:l(()=>[e("div",me,[e("div",be,[y[0]||(y[0]=e("div",{class:"w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-600 to-cyan-400 flex items-center justify-center text-white font-bold shadow-lg shadow-cyan-500/30"},[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1)),ee(e("span",_e," IPS ",512),[[te,!M.collapsed]])])]),(t(!0),c(S,null,j(m.value,i=>(t(),c(S,{key:i.id},[i.children?(t(),f(g,{key:0,index:i.id},{title:l(()=>[u(d,null,{default:l(()=>[(t(),f(P(i.icon)))]),_:2},1024),e("span",null,v(i.label),1)]),default:l(()=>[(t(!0),c(S,null,j(i.children,w=>(t(),f(_,{key:w.path,index:w.path},{default:l(()=>[e("span",null,v(w.label),1),w.highlight?(t(),c("span",ge,"NEW")):O("",!0)]),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(t(),f(_,{key:1,index:i.path},{title:l(()=>[G(v(i.label),1)]),default:l(()=>[u(d,null,{default:l(()=>[(t(),f(P(i.icon)))]),_:2},1024)]),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active","collapse"])}}}),fe=R(ke,[["__scopeId","data-v-d08142d0"]]),ve={key:0,class:"breadcrumb"},ye=H({__name:"Breadcrumb",setup(M){const r=q(),h={"/dashboard":"概览","/tasks":"任务管理","/tasks/create":"创建任务","/scheduled":"定时任务","/scheduled/history":"执行历史","/library":"镜像库","/library/import":"批量导入","/secrets":"仓库认证","/secrets/create":"添加认证","/admin":"系统设置","/admin/users":"用户管理","/admin/settings":"系统配置","/admin/logs":"系统日志"},I={"/tasks":{label:"任务管理",path:"/tasks"},"/scheduled":{label:"定时任务",path:"/scheduled"},"/library":{label:"镜像库",path:"/library"},"/secrets":{label:"仓库认证",path:"/secrets"},"/admin":{label:"系统设置",path:"/admin"}},n=x(()=>{const m=r.path,b=[],y=m.replace(/^\//,"").split("/");let d="";for(const _ of y){if(!_)continue;d+="/"+_;const g=I[d];if(g){b.find(i=>i.path===g.path)||b.push({label:g.label,path:g.path});const k=h[d];k&&b.push({label:k,path:d})}else{const k=h[d];k&&!b.find(i=>i.path===d)&&b.push({label:k,path:d})}}return b}),o=x(()=>n.value.length>0?n.value.length-1:-1);return(m,b)=>{const y=p("router-link");return n.value.length>0?(t(),c("nav",ve,[(t(!0),c(S,null,j(n.value,(d,_)=>(t(),f(y,{key:d.path,to:d.path,class:de(["breadcrumb-item",{last:_===o.value}])},{default:l(()=>[G(v(d.label),1)]),_:2},1032,["to","class"]))),128))])):O("",!0)}}}),xe=R(ye,[["__scopeId","data-v-121c886d"]]),we={class:"h-full px-6 flex items-center justify-between"},Ce={class:"flex items-center gap-4"},Se={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Me={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ie={class:"flex items-center gap-4"},Be={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Le={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},je={class:"flex items-center gap-3 hover:bg-slate-100 dark:hover:bg-slate-800 py-1.5 px-3 rounded-lg transition-colors border border-transparent hover:border-slate-200 dark:hover:border-slate-700"},Ne={class:"w-8 h-8 rounded-full bg-gradient-to-tr from-blue-500 to-indigo-500 flex items-center justify-center text-white text-sm font-bold shadow-sm"},Ue={class:"text-sm font-medium text-slate-700 dark:text-slate-200"},Ee={class:"grid grid-cols-2 gap-6 p-2"},Ae={class:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3"},De={class:"space-y-2"},Ve=["onClick"],$e={class:"text-sm text-slate-700 dark:text-slate-300 group-hover:text-blue-600 transition-colors"},ze={class:"flex gap-1"},Te=H({__name:"Layout",setup(M){const r=he(),{user:h,loadUser:I}=Q(),n=D(!1),o=D(!1),m=D(!1),b=()=>{const a=localStorage.getItem("sidebar_collapsed");a!==null&&(n.value=a==="true")},y=()=>{n.value=!n.value,localStorage.setItem("sidebar_collapsed",String(n.value))},d=()=>{const a=localStorage.getItem("dark_mode");a!==null?o.value=a==="true":o.value=window.matchMedia("(prefers-color-scheme: dark)").matches,g()},_=()=>{o.value=!o.value,localStorage.setItem("dark_mode",String(o.value)),g()},g=()=>{o.value?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},k=()=>{localStorage.removeItem("ips_token"),localStorage.removeItem("ips_user"),r.push("/login")},i=[{key:"Ctrl/Cmd + N",label:"创建任务",action:()=>r.push("/tasks/create"),category:"任务"},{key:"Ctrl/Cmd + Shift + T",label:"任务列表",action:()=>r.push("/tasks"),category:"任务"},{key:"Ctrl/Cmd + S",label:"定时任务",action:()=>r.push("/scheduled"),category:"定时"},{key:"Ctrl/Cmd + L",label:"镜像库",action:()=>r.push("/library"),category:"镜像"},{key:"Ctrl/Cmd + E",label:"仓库认证",action:()=>r.push("/secrets"),category:"镜像"},{key:"Ctrl/Cmd + A",label:"系统设置",action:()=>r.push("/admin/settings"),category:"系统"},{key:"Ctrl/Cmd + G",label:"用户管理",action:()=>r.push("/admin/users"),category:"系统"},{key:"Ctrl/Cmd + D",label:"系统日志",action:()=>r.push("/admin/logs"),category:"系统"},{key:"Ctrl/Cmd + /",label:"切换主题",action:_,category:"系统"},{key:"Escape",label:"返回上级",action:()=>r.back(),category:"导航"}],w=a=>{a.action(),m.value=!1},F=a=>{const s=a.target;if(s.tagName==="INPUT"||s.tagName==="TEXTAREA")return;const C=a.ctrlKey||a.metaKey,V=a.shiftKey;for(const E of i){const B=E.key.split(" + "),A=B[B.length-1],$=B.includes("Shift"),z=B.some(N=>N.includes("Ctrl")||N.includes("Cmd"));if(A&&a.key.toLowerCase()===A.toLowerCase()&&V===$&&C===z){a.preventDefault(),w(E);return}}},W=x(()=>{const a={};return i.forEach(s=>{const C=s.category;a[C]||(a[C]=[]),a[C].push(s)}),a}),X=x(()=>h.value&&h.value.username?h.value.username.charAt(0).toUpperCase():"U");return ie(()=>{I(),d(),b(),window.addEventListener("keydown",F)}),ce(()=>{window.removeEventListener("keydown",F)}),(a,s)=>{const C=p("el-aside"),V=p("el-dropdown-item"),E=p("el-dropdown-menu"),B=p("el-dropdown"),A=p("el-header"),$=p("router-view"),z=p("el-main"),N=p("el-container"),Y=p("el-dialog");return t(),f(N,{class:"h-screen w-full bg-slate-50 dark:bg-slate-950 transition-colors duration-300"},{default:l(()=>[u(C,{width:n.value?"64px":"260px",class:"border-r border-gray-200 dark:border-slate-800 bg-white dark:bg-slate-900 transition-all duration-300 overflow-hidden z-20"},{default:l(()=>[u(fe,{collapsed:n.value},null,8,["collapsed"])]),_:1},8,["width"]),u(N,{class:"min-w-0 flex flex-col"},{default:l(()=>[u(A,{class:"!h-16 !p-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-gray-200 dark:border-slate-800 sticky top-0 z-10"},{default:l(()=>[e("div",we,[e("div",Ce,[e("button",{class:"hidden lg:flex p-2 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",onClick:y},[n.value?(t(),c("svg",Se,[...s[1]||(s[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"},null,-1)])])):(t(),c("svg",Me,[...s[2]||(s[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)])]))]),s[3]||(s[3]=e("button",{class:"lg:hidden p-2 text-slate-500 hover:bg-slate-100 rounded-lg"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})])],-1)),u(xe)]),e("div",Ie,[e("button",{class:"p-2 text-slate-500 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800 rounded-lg transition-colors",onClick:_,title:"切换主题"},[o.value?(t(),c("svg",Be,[...s[4]||(s[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])])):(t(),c("svg",Le,[...s[5]||(s[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])]))]),u(B,{trigger:"click",class:"cursor-pointer"},{dropdown:l(()=>[u(E,{class:"min-w-[160px]"},{default:l(()=>[u(V,{divided:"",onClick:k,class:"text-red-500 hover:!text-red-600 hover:!bg-red-50"},{default:l(()=>[...s[7]||(s[7]=[e("div",{class:"flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})]),e("span",null,"退出登录")],-1)])]),_:1})]),_:1})]),default:l(()=>[e("div",je,[e("div",Ne,v(X.value),1),e("span",Ue,v(ue(h)?.username),1),s[6]||(s[6]=e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),_:1})])])]),_:1}),u(z,{class:"!p-6 overflow-y-auto relative scroll-smooth"},{default:l(()=>[u($,null,{default:l(({Component:U})=>[u(pe,{name:"fade-slide",mode:"out-in"},{default:l(()=>[(t(),f(P(U)))]),_:2},1024)]),_:1})]),_:1})]),_:1}),u(Y,{modelValue:m.value,"onUpdate:modelValue":s[0]||(s[0]=U=>m.value=U),title:"快捷键速查",width:"600px",class:"rounded-xl"},{default:l(()=>[e("div",Ee,[(t(!0),c(S,null,j(W.value,(U,J)=>(t(),c("div",{key:J},[e("h3",Ae,v(J),1),e("div",De,[(t(!0),c(S,null,j(U,(T,Z)=>(t(),c("div",{key:Z,class:"flex items-center justify-between p-2 rounded hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer group",onClick:K=>w(T)},[e("span",$e,v(T.label),1),e("div",ze,[(t(!0),c(S,null,j(T.key.split("+"),K=>(t(),c("kbd",{key:K,class:"px-2 py-1 text-xs font-mono bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded text-slate-500 dark:text-slate-400 min-w-[24px] text-center shadow-sm"},v(K.trim()),1))),128))])],8,Ve))),128))])]))),128))])]),_:1},8,["modelValue"])]),_:1})}}}),Re=R(Te,[["__scopeId","data-v-e2dc0246"]]);export{Re as default};
