import{u as x,a as N}from"./index-D5L2XjAQ.js";import{c as b,r as B,d as L,g as p,j as s,v as n,F as y,A as S,u as r,B as T,C as l,k as c,l as _,q as h,t as v,D as I}from"./element-plus-D4iBZxCD.js";import{_ as V}from"./_plugin-vue_export-helper-DlAUqK2U.js";const a=B(null),F=()=>{const f=b(()=>!!a.value),u=b(()=>a.value?.role==="admin");return{user:a,isAuthenticated:f,isAdmin:u,loadUser:()=>{const t=localStorage.getItem("ips_user");if(t)try{a.value=JSON.parse(t)}catch(m){console.error("Failed to parse user from localStorage",m)}},setUser:t=>{a.value=t,localStorage.setItem("ips_user",JSON.stringify(t))},clearUser:()=>{a.value=null,localStorage.removeItem("ips_user")}}},R={class:"layout"},D={class:"header"},J={class:"header-content"},O={class:"nav-tabs"},j={class:"user-info"},q={class:"user-avatar"},z={class:"username"},E={class:"main-content"},M=L({__name:"Layout",setup(f){const u=x(),k=N(),{user:i,isAdmin:d}=F(),t=b(()=>k.path),m=[{name:"Dashboard",path:"/web/dashboard",label:"概览"},{name:"Tasks",path:"/web/tasks",label:"任务管理"},{name:"ScheduledTasks",path:"/web/scheduled",label:"定时任务"},{name:"Library",path:"/web/library",label:"镜像库"},{name:"Secrets",path:"/web/secrets",label:"仓库认证"}],w=[{name:"Admin",path:"/web/admin",label:"系统设置"}],C=()=>{localStorage.removeItem("ips_token"),localStorage.removeItem("ips_user"),u.push("/")};return(P,o)=>{const g=h("router-link"),A=h("el-button"),U=h("router-view");return v(),p("div",R,[s("div",D,[s("div",J,[o[1]||(o[1]=s("h1",{class:"logo"},[s("span",{class:"logo-icon"}),n(" 镜像预热控制台（IPS） ")],-1)),s("nav",O,[(v(),p(y,null,S(m,e=>c(g,{key:e.path,to:e.path,class:I(["nav-link",{active:t.value===e.path}])},{default:_(()=>[n(l(e.label),1)]),_:2},1032,["to","class"])),64)),r(d)?(v(),p(y,{key:0},S(w,e=>c(g,{key:e.path,to:e.path,class:I(["nav-link",{active:t.value===e.path,"admin-only":!r(d)}])},{default:_(()=>[n(l(e.label),1)]),_:2},1032,["to","class"])),64)):T("",!0)]),s("div",j,[s("div",q,l(r(i)?.username?.charAt(0).toUpperCase()),1),s("span",z,l(r(i)?.username),1),c(A,{text:"",onClick:C},{default:_(()=>[...o[0]||(o[0]=[n("退出登录",-1)])]),_:1})])])]),s("div",E,[c(U)])])}}}),Q=V(M,[["__scopeId","data-v-d81804e6"]]);export{Q as default};
