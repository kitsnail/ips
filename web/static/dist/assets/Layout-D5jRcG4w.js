import{g as v,r as $,d as F,o as t,c as b,v as o,q as e,B as ee,C as te,l as r,D as I,F as f,a as u,G as _,H,t as c,I as P,z as R,J as se,K as oe,L as le,M as ae,N as re,O as ne,P as de,Q as ie,u as ce,T as ue}from"./element-plus-BmLo4b4r.js";import{a as G,u as pe}from"./index-DV2cirnV.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M=$(null),Q=()=>{const w=v(()=>!!M.value),n=v(()=>M.value?.role==="admin");return{user:M,isAuthenticated:w,isAdmin:n,loadUser:()=>{const a=localStorage.getItem("ips_user");if(a)try{M.value=JSON.parse(a)}catch(k){console.error("Failed to parse user from localStorage",k)}},setUser:a=>{M.value=a,localStorage.setItem("ips_user",JSON.stringify(a))},clearUser:()=>{M.value=null,localStorage.removeItem("ips_user")}}},he={class:"h-16 flex items-center justify-center border-b border-gray-100 dark:border-slate-800 mb-2 overflow-hidden"},me={class:"flex items-center gap-3"},_e={class:"text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-slate-800 to-slate-600 dark:from-white dark:to-slate-300 transition-all duration-300"},ge={key:0,class:"ml-auto px-1.5 py-0.5 text-xs font-medium bg-green-500 text-white rounded transform scale-90"},ke=F({__name:"Sidebar",props:{collapsed:{type:Boolean}},setup(w){const n=G(),{isAdmin:h}=Q(),g=v(()=>n.path),d=[{id:"dashboard",icon:se,label:"概览",path:"/dashboard"},{id:"tasks",icon:oe,label:"任务管理",path:"/tasks",children:[{id:"tasks-list",label:"全部任务",path:"/tasks"},{id:"tasks-create",label:"创建任务",path:"/tasks/create"}]},{id:"scheduled",icon:le,label:"定时任务",path:"/scheduled",children:[{id:"scheduled-list",label:"任务列表",path:"/scheduled"},{id:"scheduled-history",label:"执行历史",path:"/scheduled/history"}]},{id:"library",icon:ae,label:"镜像库",path:"/library",children:[{id:"library-list",label:"镜像管理",path:"/library"},{id:"library-import",label:"批量导入",path:"/library/import"}]},{id:"secrets",icon:re,label:"仓库认证",path:"/secrets",children:[{id:"secrets-list",label:"认证列表",path:"/secrets"},{id:"secrets-create",label:"添加认证",path:"/secrets/create"}]}],a=[{id:"admin",icon:ne,label:"系统设置",path:"/admin",children:[{id:"admin-users",label:"用户管理",path:"/admin/users"},{id:"admin-settings",label:"系统配置",path:"/admin/settings"},{id:"admin-logs",label:"系统日志",path:"/admin/logs"}]}],k=v(()=>h.value?[...d,...a]:d);return(C,i)=>{const m=u("el-icon"),B=u("el-menu-item"),N=u("el-sub-menu"),A=u("el-menu");return t(),b(A,{"default-active":g.value,collapse:w.collapsed,"collapse-transition":!1,router:"",class:"border-r-0 h-full bg-white dark:bg-slate-900","active-text-color":"#0891b2"},{default:o(()=>[e("div",he,[e("div",me,[i[0]||(i[0]=e("div",{class:"w-8 h-8 rounded-lg bg-gradient-to-br from-cyan-600 to-cyan-400 flex items-center justify-center text-white font-bold shadow-lg shadow-cyan-500/30"},[e("svg",{class:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2.5"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M13 10V3L4 14h7v7l9-11h-7z"})])],-1)),ee(e("span",_e," IPS ",512),[[te,!w.collapsed]])])]),(t(!0),r(f,null,I(k.value,p=>(t(),r(f,{key:p.id},[p.children?(t(),b(N,{key:0,index:p.id},{title:o(()=>[c(m,null,{default:o(()=>[(t(),b(P(p.icon)))]),_:2},1024),e("span",null,_(p.label),1)]),default:o(()=>[(t(!0),r(f,null,I(p.children,x=>(t(),b(B,{key:x.path,index:x.path},{default:o(()=>[e("span",null,_(x.label),1),x.highlight?(t(),r("span",ge,"NEW")):H("",!0)]),_:2},1032,["index"]))),128))]),_:2},1032,["index"])):(t(),b(B,{key:1,index:p.path},{title:o(()=>[R(_(p.label),1)]),default:o(()=>[c(m,null,{default:o(()=>[(t(),b(P(p.icon)))]),_:2},1024)]),_:2},1032,["index"]))],64))),128))]),_:1},8,["default-active","collapse"])}}}),be=q(ke,[["__scopeId","data-v-d08142d0"]]),fe={key:0,class:"flex items-center gap-2 text-sm"},ve={key:1,class:"text-slate-900 dark:text-slate-200 font-medium"},xe={key:2,class:"text-slate-300 dark:text-slate-600 font-light"},ye=F({__name:"Breadcrumb",setup(w){const n=G(),h={"/dashboard":"概览","/tasks":"任务管理","/tasks/create":"创建任务","/scheduled":"定时任务","/scheduled/history":"执行历史","/library":"镜像库","/library/import":"批量导入","/secrets":"仓库认证","/secrets/create":"添加认证","/admin":"系统设置","/admin/users":"用户管理","/admin/settings":"系统配置","/admin/logs":"系统日志"},g=v(()=>{const a=[],C=n.path.replace(/^\//,"").split("/");let i="";for(const m of C)m&&(i+="/"+m,h[i]&&a.push({label:h[i],path:i}));return a}),d=v(()=>g.value.length>0?g.value.length-1:-1);return(a,k)=>{const C=u("router-link");return g.value.length>0?(t(),r("nav",fe,[(t(!0),r(f,null,I(g.value,(i,m)=>(t(),r(f,{key:i.path},[m!==d.value?(t(),b(C,{key:0,to:i.path,class:"text-slate-500 hover:text-cyan-600 dark:text-slate-400 dark:hover:text-cyan-400 transition-colors flex items-center"},{default:o(()=>[R(_(i.label),1)]),_:2},1032,["to"])):(t(),r("span",ve,_(i.label),1)),m!==d.value?(t(),r("span",xe,"/")):H("",!0)],64))),128))])):H("",!0)}}}),we={class:"h-full px-6 flex items-center justify-between"},Ce={class:"flex items-center gap-4"},Se={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Me={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Ie={class:"flex items-center gap-4"},Be={key:0,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},je={key:1,class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},Le={class:"flex items-center gap-3 hover:bg-slate-100 dark:hover:bg-slate-800 py-1.5 px-3 rounded-lg transition-colors border border-transparent hover:border-slate-200 dark:hover:border-slate-700"},Ne={class:"w-8 h-8 rounded-full bg-gradient-to-tr from-blue-500 to-indigo-500 flex items-center justify-center text-white text-sm font-bold shadow-sm"},Ue={class:"text-sm font-medium text-slate-700 dark:text-slate-200"},Ee={class:"grid grid-cols-2 gap-6 p-2"},$e={class:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3"},Ae={class:"space-y-2"},De=["onClick"],Ve={class:"text-sm text-slate-700 dark:text-slate-300 group-hover:text-blue-600 transition-colors"},Te={class:"flex gap-1"},ze=F({__name:"Layout",setup(w){const n=pe(),{user:h,loadUser:g}=Q(),d=$(!1),a=$(!1),k=$(!1),C=()=>{const l=localStorage.getItem("sidebar_collapsed");l!==null&&(d.value=l==="true")},i=()=>{d.value=!d.value,localStorage.setItem("sidebar_collapsed",String(d.value))},m=()=>{const l=localStorage.getItem("dark_mode");l!==null?a.value=l==="true":a.value=window.matchMedia("(prefers-color-scheme: dark)").matches,N()},B=()=>{a.value=!a.value,localStorage.setItem("dark_mode",String(a.value)),N()},N=()=>{a.value?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")},A=()=>{localStorage.removeItem("ips_token"),localStorage.removeItem("ips_user"),n.push("/login")},p=[{key:"Ctrl/Cmd + N",label:"创建任务",action:()=>n.push("/tasks/create"),category:"任务"},{key:"Ctrl/Cmd + Shift + T",label:"任务列表",action:()=>n.push("/tasks"),category:"任务"},{key:"Ctrl/Cmd + S",label:"定时任务",action:()=>n.push("/scheduled"),category:"定时"},{key:"Ctrl/Cmd + L",label:"镜像库",action:()=>n.push("/library"),category:"镜像"},{key:"Ctrl/Cmd + E",label:"仓库认证",action:()=>n.push("/secrets"),category:"镜像"},{key:"Ctrl/Cmd + A",label:"系统设置",action:()=>n.push("/admin/settings"),category:"系统"},{key:"Ctrl/Cmd + G",label:"用户管理",action:()=>n.push("/admin/users"),category:"系统"},{key:"Ctrl/Cmd + D",label:"系统日志",action:()=>n.push("/admin/logs"),category:"系统"},{key:"Ctrl/Cmd + /",label:"切换主题",action:B,category:"系统"},{key:"Escape",label:"返回上级",action:()=>n.back(),category:"导航"}],x=l=>{l.action(),k.value=!1},J=l=>{const s=l.target;if(s.tagName==="INPUT"||s.tagName==="TEXTAREA")return;const y=l.ctrlKey||l.metaKey,D=l.shiftKey;for(const U of p){const S=U.key.split(" + "),E=S[S.length-1],V=S.includes("Shift"),T=S.some(j=>j.includes("Ctrl")||j.includes("Cmd"));if(E&&l.key.toLowerCase()===E.toLowerCase()&&D===V&&y===T){l.preventDefault(),x(U);return}}},W=v(()=>{const l={};return p.forEach(s=>{const y=s.category;l[y]||(l[y]=[]),l[y].push(s)}),l}),X=v(()=>h.value&&h.value.username?h.value.username.charAt(0).toUpperCase():"U");return de(()=>{g(),m(),C(),window.addEventListener("keydown",J)}),ie(()=>{window.removeEventListener("keydown",J)}),(l,s)=>{const y=u("el-aside"),D=u("el-dropdown-item"),U=u("el-dropdown-menu"),S=u("el-dropdown"),E=u("el-header"),V=u("router-view"),T=u("el-main"),j=u("el-container"),Y=u("el-dialog");return t(),b(j,{class:"h-screen w-full bg-slate-50 dark:bg-slate-950 transition-colors duration-300"},{default:o(()=>[c(y,{width:d.value?"64px":"260px",class:"border-r border-gray-200 dark:border-slate-800 bg-white dark:bg-slate-900 transition-all duration-300 overflow-hidden z-20"},{default:o(()=>[c(be,{collapsed:d.value},null,8,["collapsed"])]),_:1},8,["width"]),c(j,{class:"min-w-0 flex flex-col"},{default:o(()=>[c(E,{class:"!h-16 !p-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md border-b border-gray-200 dark:border-slate-800 sticky top-0 z-10"},{default:o(()=>[e("div",we,[e("div",Ce,[e("button",{class:"hidden lg:flex p-2 text-slate-500 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",onClick:i},[d.value?(t(),r("svg",Se,[...s[1]||(s[1]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M13 5l7 7-7 7M5 5l7 7-7 7"},null,-1)])])):(t(),r("svg",Me,[...s[2]||(s[2]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 19l-7-7 7-7m8 14l-7-7 7-7"},null,-1)])]))]),s[3]||(s[3]=e("button",{class:"lg:hidden p-2 text-slate-500 hover:bg-slate-100 rounded-lg"},[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})])],-1)),c(ye)]),e("div",Ie,[e("button",{class:"p-2 text-slate-500 hover:bg-slate-100 dark:text-slate-400 dark:hover:bg-slate-800 rounded-lg transition-colors",onClick:B,title:"切换主题"},[a.value?(t(),r("svg",Be,[...s[4]||(s[4]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])])):(t(),r("svg",je,[...s[5]||(s[5]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])]))]),c(S,{trigger:"click",class:"cursor-pointer"},{dropdown:o(()=>[c(U,{class:"min-w-[160px]"},{default:o(()=>[c(D,{divided:"",onClick:A,class:"text-red-500 hover:!text-red-600 hover:!bg-red-50"},{default:o(()=>[...s[7]||(s[7]=[e("div",{class:"flex items-center gap-2"},[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"})]),e("span",null,"退出登录")],-1)])]),_:1})]),_:1})]),default:o(()=>[e("div",Le,[e("div",Ne,_(X.value),1),e("span",Ue,_(ce(h)?.username),1),s[6]||(s[6]=e("svg",{class:"w-4 h-4 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"})],-1))])]),_:1})])])]),_:1}),c(T,{class:"!p-6 overflow-y-auto relative scroll-smooth"},{default:o(()=>[c(V,null,{default:o(({Component:L})=>[c(ue,{name:"fade-slide",mode:"out-in"},{default:o(()=>[(t(),b(P(L)))]),_:2},1024)]),_:1})]),_:1})]),_:1}),c(Y,{modelValue:k.value,"onUpdate:modelValue":s[0]||(s[0]=L=>k.value=L),title:"快捷键速查",width:"600px",class:"rounded-xl"},{default:o(()=>[e("div",Ee,[(t(!0),r(f,null,I(W.value,(L,O)=>(t(),r("div",{key:O},[e("h3",$e,_(O),1),e("div",Ae,[(t(!0),r(f,null,I(L,(z,Z)=>(t(),r("div",{key:Z,class:"flex items-center justify-between p-2 rounded hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer group",onClick:K=>x(z)},[e("span",Ve,_(z.label),1),e("div",Te,[(t(!0),r(f,null,I(z.key.split("+"),K=>(t(),r("kbd",{key:K,class:"px-2 py-1 text-xs font-mono bg-slate-100 dark:bg-slate-700 border border-slate-200 dark:border-slate-600 rounded text-slate-500 dark:text-slate-400 min-w-[24px] text-center shadow-sm"},_(K.trim()),1))),128))])],8,De))),128))])]))),128))])]),_:1},8,["modelValue"])]),_:1})}}}),Fe=q(ze,[["__scopeId","data-v-e2dc0246"]]);export{Fe as default};
