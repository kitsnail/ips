import{d as P,Q as F,R as q,l as n,q as s,t as r,v as c,G as d,c as G,F as I,D as T,H as _,r as v,g as Q,a as w,o,z as m,P as J,A as U}from"./element-plus-K37pJI3g.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const W={class:"admin-logs"},X={class:"page-header"},Y={class:"header-actions"},Z={class:"filters-section"},ee={class:"filter-group"},se={class:"filter-group"},le={class:"log-count"},te={key:1,class:"logs-list"},ae=["onClick"],oe={class:"log-header"},ne={class:"log-timestamp"},ie={key:0,class:"log-level-icon"},re={key:1,class:"log-level-icon"},de={key:2,class:"log-level-icon"},ce={class:"log-message"},ue={key:0,class:"log-details"},ve={key:0,class:"log-detail-panel"},me={class:"detail-header"},pe={class:"detail-content"},ge={class:"detail-row"},_e={class:"detail-value"},we={class:"detail-row"},fe={class:"detail-row"},he={class:"detail-message"},ke={key:0,class:"detail-row"},ye={class:"detail-value"},Le=P({__name:"AdminLogsView",setup(Ce){const k=v([]),y=v(!1),p=v(!1),i=v(null),f=v(null),$=["all","info","warning","error","success"],L=v("all"),C=v(""),z=Q(()=>{let l=k.value;if(L.value!=="all"&&(l=l.filter(e=>e.level===L.value)),C.value){const e=C.value.toLowerCase();l=l.filter(a=>a.message.toLowerCase().includes(e)||a.details&&a.details.toLowerCase().includes(e))}return l}),b=l=>{switch(l){case"error":return"danger";case"warning":return"warning";case"success":return"success";default:return"info"}},x=l=>({all:"全部",info:"信息",warning:"警告",error:"错误",success:"成功"})[l]||l,S=async()=>{y.value=!0,await new Promise(l=>setTimeout(l,500)),k.value=[{timestamp:new Date(Date.now()-6e4).toISOString(),level:"info",message:"系统启动完成，监听端口 8080",details:"PID: 12345"},{timestamp:new Date(Date.now()-5e4).toISOString(),level:"success",message:"用户 admin 登录成功",details:"IP: 192.168.1.100, User-Agent: Mozilla/5.0"},{timestamp:new Date(Date.now()-4e4).toISOString(),level:"warning",message:"任务 Task-001 执行超时",details:"TaskID: Task-001, 超时时间: 300s"},{timestamp:new Date(Date.now()-3e4).toISOString(),level:"error",message:"拉取镜像 docker.io/library/nginx:latest 失败: connection timeout",details:"Node: node-01, Error: dial tcp i/o timeout"}],y.value=!1},B=()=>{const l=k.value.map(u=>`[${new Date(u.timestamp).toLocaleString()}] [${u.level.toUpperCase()}] ${u.message}${u.details?` | ${u.details}`:""}`).join(`
`),e=new Blob([l],{type:"text/plain"}),a=URL.createObjectURL(e),h=document.createElement("a");h.href=a,h.download=`ips-logs-${new Date().toISOString().split("T")[0]}.txt`,h.click(),URL.revokeObjectURL(a),U.success("日志导出成功")},M=()=>{k.value=[],U.info("日志已清空")},O=()=>{if(p.value&&f.value){const l=f.value;l.scrollTop=l.scrollHeight}};let g=null;const j=()=>{p.value=!p.value,p.value?(O(),g=window.setInterval(()=>{if(f.value){const l=f.value;l.scrollTop=l.scrollHeight}},100)):g&&(clearInterval(g),g=null)},N=l=>{i.value=i.value===l?null:l},A=()=>{S()},V=l=>new Date(l).toLocaleString("zh-CN",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"});return F(()=>{S()}),q(()=>{g&&clearInterval(g)}),(l,e)=>{const a=w("el-button"),h=w("el-option"),u=w("el-select"),E=w("el-input"),H=w("el-empty"),D=w("el-tag");return o(),n("div",W,[s("div",X,[e[6]||(e[6]=s("h1",null,"系统日志",-1)),s("div",Y,[r(a,{onClick:A,loading:y.value},{default:c(()=>[...e[3]||(e[3]=[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M4 4v5a.5.5 0 00-1 0v-5h4l-4 4m0-5h4V4a.5.5 0 011-1 0v5zm0 7a.5.5 0 000-1v1h6a.5.5 0 001 1v-1H4a.5.5 0 000-1zm6-5a.5.5 0 000-1v5a.5.5 0 000-1 0 5l-3-3a.5.5 0 000-1zm5 2h4a.5.5 0 00-1V5a.5.5 0 001 1V8a.5.5 0 001-1z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),m(" 刷新 ",-1)])]),_:1},8,["loading"]),r(a,{onClick:B},{default:c(()=>[...e[4]||(e[4]=[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M21 15v4a2 2 0 00-2 2v-4h2a2 2 0 00-4 4-6a.5.5 0 000-4zm-2 4v14a2 2 0 002 2v-4h2a2 2 0 002 2v-4zm0 0h2v1a.5.5 0 000-1v1h1a.5.5 0 000-1v1H4a.5.5 0 000-1zm1 11h3a2 2 0 00-1-1.5V15h-4a2 2 0 00-4 4-9a.5.5 0 000-1z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),m(" 导出 ",-1)])]),_:1}),r(a,{onClick:M},{default:c(()=>[...e[5]||(e[5]=[s("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[s("path",{d:"M19 7l-.867 5.5-.867-5.5a.5.5 0 01-.708 0-1.292-.708 1.292l.708.708 1.708L19 12z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),m(" 清空 ",-1)])]),_:1}),r(a,{onClick:j,type:p.value?"primary":"default",size:"small"},{default:c(()=>[m(d(p.value?"停止":"开始")+"滚动 ",1)]),_:1},8,["type"])])]),s("div",Z,[s("div",ee,[e[7]||(e[7]=s("span",{class:"filter-label"},"日志级别:",-1)),r(u,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=t=>L.value=t),size:"small",class:"filter-select"},{default:c(()=>[(o(),n(I,null,T($,t=>r(h,{key:t,label:x(t),value:t},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),s("div",se,[r(E,{modelValue:C.value,"onUpdate:modelValue":e[1]||(e[1]=t=>C.value=t),placeholder:"搜索日志...","prefix-icon":"Search",size:"small",class:"search-input",clearable:""},null,8,["modelValue"]),s("span",le,d(z.value.length)+" 条",1)])]),s("div",{class:"logs-container",ref_key:"logContainer",ref:f},[!y.value&&z.value.length===0?(o(),G(H,{key:0,description:"暂无日志记录","image-size":120})):(o(),n("div",te,[(o(!0),n(I,null,T(z.value,(t,R)=>(o(),n("div",{key:R,class:J(["log-item",`log-${t.level}`]),onClick:ze=>N(t)},[s("div",oe,[s("span",ne,d(V(t.timestamp)),1),r(D,{type:b(t.level),size:"small",class:"log-level"},{default:c(()=>[m(d(x(t.level)),1)]),_:2},1032,["type"]),t.level==="error"?(o(),n("span",ie,"⚠️")):_("",!0),t.level==="warning"?(o(),n("span",re,"⚡️")):_("",!0),t.level==="success"?(o(),n("span",de,"✅")):_("",!0)]),s("div",ce,d(t.message),1),t.details?(o(),n("div",ue,d(t.details),1)):_("",!0)],10,ae))),128))]))],512),i.value?(o(),n("div",ve,[s("div",me,[e[9]||(e[9]=s("h3",null,"日志详情",-1)),r(a,{size:"small",onClick:e[2]||(e[2]=t=>i.value=null),text:""},{default:c(()=>[...e[8]||(e[8]=[m("关闭",-1)])]),_:1})]),s("div",pe,[s("div",ge,[e[10]||(e[10]=s("span",{class:"detail-label"},"时间:",-1)),s("span",_e,d(V(i.value.timestamp)),1)]),s("div",we,[e[11]||(e[11]=s("span",{class:"detail-label"},"级别:",-1)),r(D,{type:b(i.value.level),size:"small"},{default:c(()=>[m(d(x(i.value.level)),1)]),_:1},8,["type"])]),s("div",fe,[e[12]||(e[12]=s("span",{class:"detail-label"},"消息:",-1)),s("span",he,d(i.value.message),1)]),i.value.details?(o(),n("div",ke,[e[13]||(e[13]=s("span",{class:"detail-label"},"详情:",-1)),s("span",ye,d(i.value.details),1)])):_("",!0)])])):_("",!0)])}}}),Se=K(Le,[["__scopeId","data-v-9635a870"]]);export{Se as default};
