import{t as T}from"./index-BzXyuT2b.js";import{d as x,G as D,H as V,g,j as k,k as s,l as a,I as B,f as M,r as _,E as S,q as r,J as N,t as f,v as o,C as i,B as A}from"./element-plus-BS5ldEX1.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";const U={class:"tasks"},$={class:"header"},j={key:0},q=x({__name:"TasksView",setup(z){const m=_([]),d=_(!1),c=_(!1);let p=null;const u=async()=>{try{d.value=!0;const n=await T.list({limit:10,offset:0});m.value=n.tasks}catch{S.error("加载任务失败")}finally{d.value=!1}},b=()=>{u()},w=n=>{console.log("Show detail for task:",n.taskId)};return D(()=>{u(),p=window.setInterval(()=>{u()},5e3)}),V(()=>{p&&clearInterval(p)}),(n,t)=>{const v=r("el-button"),l=r("el-table-column"),h=r("el-tag"),C=r("el-table"),y=r("CreateTaskModal"),I=N("loading");return f(),g("div",U,[k("div",$,[t[3]||(t[3]=k("h2",null,"任务管理",-1)),s(v,{type:"primary",onClick:t[0]||(t[0]=e=>c.value=!0)},{default:a(()=>[...t[2]||(t[2]=[o("新建任务",-1)])]),_:1})]),B((f(),M(C,{data:m.value,style:{width:"100%"}},{default:a(()=>[s(l,{prop:"taskId",label:"任务ID",width:"180"}),s(l,{prop:"status",label:"状态",width:"100"},{default:a(({row:e})=>[s(h,{type:e.status==="completed"?"success":e.status==="failed"?"danger":"info"},{default:a(()=>[o(i(e.status),1)]),_:2},1032,["type"])]),_:1}),s(l,{prop:"images",label:"镜像"},{default:a(({row:e})=>[o(i(e.images[0])+" ",1),e.images.length>1?(f(),g("span",j,"+"+i(e.images.length-1),1)):A("",!0)]),_:1}),s(l,{prop:"progress.percentage",label:"进度",width:"120"},{default:a(({row:e})=>[o(i(e.progress?.percentage?.toFixed(1)||0)+"% ",1)]),_:1}),s(l,{prop:"createdAt",label:"创建时间",width:"180"},{default:a(({row:e})=>[o(i(new Date(e.createdAt).toLocaleString()),1)]),_:1}),s(l,{label:"操作",width:"150"},{default:a(({row:e})=>[s(v,{size:"small",onClick:F=>w(e)},{default:a(()=>[...t[4]||(t[4]=[o("详情",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[I,d.value]]),s(y,{visible:c.value,"onUpdate:visible":t[1]||(t[1]=e=>c.value=e),onSuccess:b},null,8,["visible"])])}}}),L=E(q,[["__scopeId","data-v-e6b96fbb"]]);export{L as default};
