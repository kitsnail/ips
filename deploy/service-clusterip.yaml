---
# ClusterIP Service - 用于 Ingress 或集群内访问
apiVersion: v1
kind: Service
metadata:
  name: ips-apiserver
  namespace: ips-system
  labels:
    app: ips
    component: apiserver
spec:
  type: ClusterIP
  selector:
    app: ips
    component: apiserver
  ports:
    - name: http
      port: 8080
      targetPort: http
      protocol: TCP
  # 会话亲和性：确保来自同一客户端的请求路由到同一个 Pod
  sessionAffinity: ClientIP
  sessionAffinityConfig:
    clientIP:
      timeoutSeconds: 10800  # 3 小时
